<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>수학 풀이 코칭 v0.1</title>
<style>
  :root { --bg:#0f1220; --card:#171a2b; --accent:#6ea8fe; --text:#e9edf5; --muted:#9aa3b2; --ok:#4ade80; --warn:#fbbf24; --bad:#f87171; }
  *{box-sizing:border-box;font-family:system-ui,Segoe UI,Apple SD Gothic Neo,Malgun Gothic,sans-serif}
  body{margin:0;background:var(--bg);color:var(--text)}
  header{padding:16px 20px;border-bottom:1px solid #23263a}
  header h1{margin:0;font-size:20px}
  header p{margin:6px 0 0;color:var(--muted);font-size:13px}
  .container{max-width:920px;margin:0 auto;padding:16px}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  .tab{flex:1;min-width:180px;background:var(--card);border:1px solid #23263a;padding:10px 12px;border-radius:10px;cursor:pointer;text-align:center;color:var(--muted)}
  .tab.active{outline:2px solid var(--accent);color:var(--text)}
  .card{background:var(--card);border:1px solid #23263a;border-radius:12px;padding:16px;margin-bottom:14px}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .col{flex:1;min-width:220px}
  label{display:block;margin:8px 0 4px;color:#c7cede;font-size:13px}
  input{width:100%;padding:10px;border-radius:8px;border:1px solid #2a2e44;background:#121428;color:var(--text)}
  .btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
  button{padding:10px 12px;border:1px solid #2a2e44;background:#121428;color:var(--text);border-radius:8px;cursor:pointer}
  button.primary{background:var(--accent);border-color:var(--accent);color:#0b1020}
  .hint{background:#101325;border-left:4px solid var(--accent);padding:10px 12px;border-radius:8px;margin:8px 0}
  .muted{color:var(--muted);font-size:13px}
  .ok{color:var(--ok);font-weight:600}
  .bad{color:var(--bad);font-weight:600}
  .warn{color:var(--warn);font-weight:600}
  .steps ol{margin:10px 0 0 18px}
  .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;border:1px solid #2a2e44;background:#0f1220;color:#cfd6ea}
  footer{padding:16px 20px;color:var(--muted);font-size:12px;border-top:1px solid #23263a}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media(max-width:800px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<header>
  <h1>수학 풀이 코칭 v0.1</h1>
  <p>정답이 아니라 “과정”을 배웁니다. 힌트 → 단계 → 검산 순서로 보세요. <span class="badge">학습 보조용</span></p>
</header>

<div class="container">
  <div class="tabs">
    <div class="tab active" data-tab="linear">1차 방정식</div>
    <div class="tab" data-tab="quadratic">이차 방정식</div>
    <div class="tab" data-tab="system">연립방정식(2×2)</div>
  </div>

  <!-- 1차 방정식 -->
  <section class="card" id="linear">
    <h3>형식: a·x + b = c</h3>
    <div class="grid">
      <div class="col">
        <label>a</label><input id="lin-a" type="number" value="2">
        <label>b</label><input id="lin-b" type="number" value="3">
        <label>c</label><input id="lin-c" type="number" value="11">
        <div class="btns">
          <button class="primary" id="lin-step1">단계 1 보기</button>
          <button id="lin-step2">단계 2 보기</button>
          <button id="lin-answer">정답 보기</button>
          <button id="lin-verify">검산하기</button>
          <button id="lin-reset">초기화</button>
        </div>
        <p class="muted">힌트를 순서대로 보셔야 정답 버튼이 열립니다.</p>
      </div>
      <div class="col steps" id="lin-steps">
        <div class="hint">예: 2x+3=11 → x는 무엇일까요?</div>
        <ol></ol>
        <div id="lin-result"></div>
      </div>
    </div>
  </section>

  <!-- 이차 방정식 -->
  <section class="card" id="quadratic" style="display:none">
    <h3>형식: a·x² + b·x + c = 0</h3>
    <div class="grid">
      <div class="col">
        <label>a</label><input id="quad-a" type="number" value="1">
        <label>b</label><input id="quad-b" type="number" value="-5">
        <label>c</label><input id="quad-c" type="number" value="6">
        <div class="btns">
          <button class="primary" id="quad-step1">단계 1 보기</button>
          <button id="quad-step2">단계 2 보기</button>
          <button id="quad-answer">정답 보기</button>
          <button id="quad-verify">검산하기</button>
          <button id="quad-reset">초기화</button>
        </div>
        <p class="muted">판별식→근의 공식→검산 순으로 진행됩니다.</p>
      </div>
      <div class="col steps" id="quad-steps">
        <div class="hint">예: x²−5x+6=0 → 근을 구해 봅시다.</div>
        <ol></ol>
        <div id="quad-result"></div>
      </div>
    </div>
  </section>

  <!-- 연립방정식 -->
  <section class="card" id="system" style="display:none">
    <h3>형식: a₁x + b₁y = c₁, a₂x + b₂y = c₂</h3>
    <div class="grid">
      <div class="col">
        <label>a₁</label><input id="sys-a1" type="number" value="2">
        <label>b₁</label><input id="sys-b1" type="number" value="1">
        <label>c₁</label><input id="sys-c1" type="number" value="11">
      </div>
      <div class="col">
        <label>a₂</label><input id="sys-a2" type="number" value="1">
        <label>b₂</label><input id="sys-b2" type="number" value="1">
        <label>c₂</label><input id="sys-c2" type="number" value="8">
      </div>
    </div>
    <div class="btns" style="margin-top:8px">
      <button class="primary" id="sys-step1">단계 1 보기</button>
      <button id="sys-step2">단계 2 보기</button>
      <button id="sys-answer">정답 보기</button>
      <button id="sys-verify">검산하기</button>
      <button id="sys-reset">초기화</button>
    </div>
    <p class="muted">Cramer의 공식(Δ, Δx, Δy)으로 풉니다.</p>
    <div class="steps" id="sys-steps" style="margin-top:8px">
      <div class="hint">예: 2x+y=11, x+y=8</div>
      <ol></ol>
      <div id="sys-result"></div>
    </div>
  </section>

  <section class="card">
    <strong>유의:</strong> 본 앱은 학습 보조용입니다. 힌트를 거치지 않으면 정답을 열 수 없으며, 검산을 통과해야 완료로 표시됩니다.
  </section>
</div>

<footer>
  © 학습 코칭용 데모. 개인정보를 수집하지 않습니다. 배포·결제 등은 보호자와 상의하세요.
</footer>

<script>
  // 탭 전환
  document.querySelectorAll('.tab').forEach(t=>{
    t.addEventListener('click', ()=>{
      document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      const tab = t.dataset.tab;
      ['linear','quadratic','system'].forEach(id=>{
        document.getElementById(id).style.display = (id===tab)?'block':'none';
      });
    });
  });

  // 공용 유틸
  const gcd=(a,b)=>{a=Math.abs(a);b=Math.abs(b);while(b){[a,b]=[b,a%b]}return a||1};
  const isInt=(v)=>Number.isInteger(v);
  const sgn=(n)=> n>=0?'+':'-';
  const simpFrac=(num,den)=>{
    if(den===0) return '정의되지 않음';
    if(num===0) return '0';
    const g=gcd(num,den);
    num/=g; den/=g;
    if(den<0){den*=-1;num*=-1}
    return (den===1)? `${num}` : `${num}/${den}`;
  };
  const fmtExprLinear=(a,b,c)=>{
    const aStr = (a===1)?'x':(a===-1)?'-x':`${a}x`;
    const bStr = b===0?'':` ${sgn(b)} ${Math.abs(b)}`;
    return `${aStr}${bStr} = ${c}`;
  };

  // 상태(힌트 잠금)
  const gate = {
    lin: {s1:false,s2:false,ans:false},
    quad:{s1:false,s2:false,ans:false},
    sys: {s1:false,s2:false,ans:false}
  };

  // 1차 방정식
  const linStepsOl = document.querySelector('#lin-steps ol');
  const linResult = document.getElementById('lin-result');
  const linReset = ()=>{
    linStepsOl.innerHTML = '';
    linResult.innerHTML = '';
    gate.lin = {s1:false,s2:false,ans:false};
  };
  document.getElementById('lin-reset').onclick = linReset;

  document.getElementById('lin-step1').onclick = ()=>{
    const a=+document.getElementById('lin-a').value;
    const b=+document.getElementById('lin-b').value;
    const c=+document.getElementById('lin-c').value;
    if(a===0){alert('a=0이면 1차 방정식이 아닙니다.');return;}
    linStepsOl.innerHTML = '';
    const li1=document.createElement('li');
    li1.textContent = `표준형으로 정리: ${fmtExprLinear(a,b,c)}`;
    linStepsOl.appendChild(li1);
    const li2=document.createElement('li');
    li2.textContent = `상수항을 이항: ${a}x = ${c} ${b>=0?'-':'+'} ${Math.abs(b)} ⇒ ${a}x = ${c-b}`;
    linStepsOl.appendChild(li2);
    gate.lin.s1 = true;
    gate.lin.s2 = false; gate.lin.ans = false;
    linResult.innerHTML = '';
  };

  document.getElementById('lin-step2').onclick = ()=>{
    if(!gate.lin.s1){alert('먼저 단계 1을 보세요.');return;}
    const a=+document.getElementById('lin-a').value;
    const b=+document.getElementById('lin-b').value;
    const c=+document.getElementById('lin-c').value;
    const num = (c-b), den = a;
    const li3=document.createElement('li');
    li3.textContent = `양변을 ${a}로 나눔: x = (${c} - ${b}) / ${a} = ${simpFrac(num,den)}`;
    linStepsOl.appendChild(li3);
    gate.lin.s2 = true; gate.lin.ans = false;
  };

  document.getElementById('lin-answer').onclick = ()=>{
    if(!(gate.lin.s1 && gate.lin.s2)){alert('힌트를 모두 본 뒤 정답을 확인할 수 있습니다.');return;}
    const a=+document.getElementById('lin-a').value;
    const b=+document.getElementById('lin-b').value;
    const c=+document.getElementById('lin-c').value;
    const num = (c-b), den = a;
    const x = num/den;
    linResult.innerHTML = `<div class="hint"><strong>정답:</strong> x = ${simpFrac(num,den)} ${!isInt(x)?`(≈ ${x.toFixed(6)})`:''}</div>`;
    gate.lin.ans = true;
  };

  document.getElementById('lin-verify').onclick = ()=>{
    if(!gate.lin.ans){alert('정답 확인 후 검산하세요.');return;}
    const a=+document.getElementById('lin-a').value;
    const b=+document.getElementById('lin-b').value;
    const c=+document.getElementById('lin-c').value;
    const x = (c-b)/a;
    const lhs = a*x + b;
    const ok = Math.abs(lhs - c) < 1e-9;
    linResult.innerHTML += `<div class="hint">${ok?'<span class="ok">검산 통과</span>':'<span class="bad">검산 실패</span>'} — 좌변 a·x+b = ${lhs.toFixed(6)}, 우변 = ${c}</div>`;
  };

  // 이차 방정식
  const quadOl = document.querySelector('#quad-steps ol');
  const quadResult = document.getElementById('quad-result');
  const isPerfectSquare = (n)=> n>=0 && Number.isInteger(Math.sqrt(n));
  const quadReset = ()=>{quadOl.innerHTML=''; quadResult.innerHTML=''; gate.quad={s1:false,s2:false,ans:false};};
  document.getElementById('quad-reset').onclick = quadReset;

  document.getElementById('quad-step1').onclick = ()=>{
    const a=+document.getElementById('quad-a').value;
    const b=+document.getElementById('quad-b').value;
    const c=+document.getElementById('quad-c').value;
    if(a===0){alert('a=0이면 이차 방정식이 아닙니다.');return;}
    quadOl.innerHTML='';
    const li1=document.createElement('li');
    li1.textContent = `표준형 확인: ${a===1?'':a+'·'}x² ${b>=0?'+':'-'} ${Math.abs(b)}·x ${c>=0?'+':'-'} ${Math.abs(c)} = 0`;
    quadOl.appendChild(li1);
    const D = b*b - 4*a*c;
    const li2=document.createElement('li');
    li2.textContent = `판별식 D = b² - 4ac = ${b}² - 4·${a}·${c} = ${D}`;
    quadOl.appendChild(li2);
    gate.quad.s1=true; gate.quad.s2=false; gate.quad.ans=false;
    quadResult.innerHTML='';
  };

  document.getElementById('quad-step2').onclick = ()=>{
    if(!gate.quad.s1){alert('먼저 단계 1을 보세요.');return;}
    const a=+document.getElementById('quad-a').value;
    const b=+document.getElementById('quad-b').value;
    const c=+document.getElementById('quad-c').value;
    const D = b*b - 4*a*c;
    const li3=document.createElement('li');
    if(D>0){
      li3.textContent = '실수의 서로 다른 두 근(±)이 존재합니다.';
    }else if(D===0){
      li3.textContent = '중근(한 근)이 존재합니다.';
    }else{
      li3.textContent = '실수근이 없고 서로 다른 두 허근이 존재합니다.';
    }
    quadOl.appendChild(li3);
    gate.quad.s2=true; gate.quad.ans=false;
  };

  document.getElementById('quad-answer').onclick = ()=>{
    if(!(gate.quad.s1 && gate.quad.s2)){alert('힌트를 모두 본 뒤 정답을 확인할 수 있습니다.');return;}
    const a=+document.getElementById('quad-a').value;
    const b=+document.getElementById('quad-b').value;
    const c=+document.getElementById('quad-c').value;
    const D = b*b - 4*a*c;
    let html = '<div class="hint"><strong>정답:</strong> ';
    if(D>=0){
      const sqrtD = Math.sqrt(D);
      // 정확식
      const exact = isPerfectSquare(D)
        ? `x = (${ -b } ± ${ sqrtD }) / ${2*a}`
        : `x = (${ -b } ± √${D}) / ${2*a}`;
      // 근값
      let approx = '';
      if(a!==0){
        const x1 = (-b + Math.sqrt(Math.abs(D))) / (2*a);
        const x2 = (-b - Math.sqrt(Math.abs(D))) / (2*a);
        approx = ` ⇒ x ≈ ${x1.toFixed(6)}, ${x2.toFixed(6)}`;
      }
      html += `${exact}${approx}</div>`;
    }else{
      const sqrtAbs = Math.sqrt(-D);
      html += `x = (${ -b } ± i·√${-D}) / ${2*a}</div>`;
      html += `<div class="hint">허근 형태(복소수). a≠0, D<0이므로 실수해는 없습니다.</div>`;
    }
    quadResult.innerHTML = html;
    gate.quad.ans = true;
  };

  document.getElementById('quad-verify').onclick = ()=>{
    if(!gate.quad.ans){alert('정답 확인 후 검산하세요.');return;}
    const a=+document.getElementById('quad-a').value;
    const b=+document.getElementById('quad-b').value;
    const c=+document.getElementById('quad-c').value;
    const D = b*b - 4*a*c;
    if(D<0){quadResult.innerHTML += `<div class="hint warn">실수근이 없어 실수 범위 검산은 해당 없음.</div>`; return;}
    const x1 = (-b + Math.sqrt(D)) / (2*a);
    const x2 = (-b - Math.sqrt(D)) / (2*a);
    const f=(x)=> a*x*x + b*x + c;
    const ok1 = Math.abs(f(x1))<1e-6;
    const ok2 = Math.abs(f(x2))<1e-6;
    quadResult.innerHTML += `<div class="hint">${ok1&&ok2?'<span class="ok">검산 통과</span>':'<span class="bad">검산 확인 필요</span>'} — f(x1)=${f(x1).toExponential(2)}, f(x2)=${f(x2).toExponential(2)}</div>`;
  };

  // 연립방정식(2×2)
  const sysOl = document.querySelector('#sys-steps ol');
  const sysResult = document.getElementById('sys-result');
  const sysReset = ()=>{sysOl.innerHTML=''; sysResult.innerHTML=''; gate.sys={s1:false,s2:false,ans:false};};
  document.getElementById('sys-reset').onclick = sysReset;

  document.getElementById('sys-step1').onclick = ()=>{
    const a1=+document.getElementById('sys-a1').value;
    const b1=+document.getElementById('sys-b1').value;
    const c1=+document.getElementById('sys-c1').value;
    const a2=+document.getElementById('sys-a2').value;
    const b2=+document.getElementById('sys-b2').value;
    const c2=+document.getElementById('sys-c2').value;
    sysOl.innerHTML='';
    const li1=document.createElement('li');
    li1.textContent = `표준형 확인: ${a1}x ${sgn(b1)} ${Math.abs(b1)}y = ${c1},  ${a2}x ${sgn(b2)} ${Math.abs(b2)}y = ${c2}`;
    sysOl.appendChild(li1);
    const Δ = a1*b2 - b1*a2;
    const li2=document.createElement('li');
    li2.textContent = `Δ = a₁b₂ − b₁a₂ = ${a1}·${b2} − ${b1}·${a2} = ${Δ}`;
    sysOl.appendChild(li2);
    gate.sys.s1=true; gate.sys.s2=false; gate.sys.ans=false;
    sysResult.innerHTML='';
  };

  document.getElementById('sys-step2').onclick = ()=>{
    if(!gate.sys.s1){alert('먼저 단계 1을 보세요.');return;}
    const a1=+document.getElementById('sys-a1').value;
    const b1=+document.getElementById('sys-b1').value;
    const c1=+document.getElementById('sys-c1').value;
    const a2=+document.getElementById('sys-a2').value;
    const b2=+document.getElementById('sys-b2').value;
    const c2=+document.getElementById('sys-c2').value;
    const Δ = a1*b2 - b1*a2;
    const li3=document.createElement('li');
    if(Δ===0){
      li3.innerHTML = 'Δ=0 → 해가 하나로 정해지지 않습니다(무수히 많거나, 모순으로 해가 없을 수 있음).';
    }else{
      li3.textContent = 'Δ≠0 → 유일해가 존재합니다. 다음 단계로 진행합니다.';
    }
    sysOl.appendChild(li3);
    gate.sys.s2=true; gate.sys.ans=false;
  };

  document.getElementById('sys-answer').onclick = ()=>{
    if(!(gate.sys.s1 && gate.sys.s2)){alert('힌트를 모두 본 뒤 정답을 확인할 수 있습니다.');return;}
    const a1=+document.getElementById('sys-a1').value;
    const b1=+document.getElementById('sys-b1').value;
    const c1=+document.getElementById('sys-c1').value;
    const a2=+document.getElementById('sys-a2').value;
    const b2=+document.getElementById('sys-b2').value;
    const c2=+document.getElementById('sys-c2').value;
    const Δ = a1*b2 - b1*a2;
    if(Δ===0){ sysResult.innerHTML = '<div class="hint warn">Δ=0 상태 — 유일해 없음(특수 케이스)</div>'; return; }
    const Δx = c1*b2 - b1*c2;
    const Δy = a1*c2 - c1*a2;
    const xStr = simpFrac(Δx, Δ);
    const yStr = simpFrac(Δy, Δ);
    let approx = '';
    const x=Δx/Δ, y=Δy/Δ;
    approx = ` (x≈${x.toFixed(6)}, y≈${y.toFixed(6)})`;
    sysResult.innerHTML = `<div class="hint"><strong>정답:</strong> x = ${xStr}, y = ${yStr}${approx}</div>
      <div class="hint">Cramer: x=Δx/Δ, y=Δy/Δ where Δ=${Δ}, Δx=${Δx}, Δy=${Δy}</div>`;
    gate.sys.ans=true;
  };

  document.getElementById('sys-verify').onclick = ()=>{
    if(!gate.sys.ans){alert('정답 확인 후 검산하세요.');return;}
    const a1=+document.getElementById('sys-a1').value;
    const b1=+document.getElementById('sys-b1').value;
    const c1=+document.getElementById('sys-c1').value;
    const a2=+document.getElementById('sys-a2').value;
    const b2=+document.getElementById('sys-b2').value;
    const c2=+document.getElementById('sys-c2').value;
    const Δ = a1*b2 - b1*a2;
    if(Δ===0){ return; }
    const x=(c1*b2 - b1*c2)/Δ;
    const y=(a1*c2 - c1*a2)/Δ;
    const ok1 = Math.abs(a1*x + b1*y - c1)<1e-9;
    const ok2 = Math.abs(a2*x + b2*y - c2)<1e-9;
    sysResult.innerHTML += `<div class="hint">${(ok1&&ok2)?'<span class="ok">검산 통과</span>':'<span class="bad">검산 실패</span>'} — 식1: ${ (a1*x + b1*y).toFixed(6)} vs ${c1}, 식2: ${(a2*x + b2*y).toFixed(6)} vs ${c2}</div>`;
  };
</script>
</body>
</html>